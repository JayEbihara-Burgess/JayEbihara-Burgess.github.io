import http.server
import socketserver
import os
import webbrowser

# List of ports to try
PORTS = [8000, 8080, 5000, 3000]

# ⚠️ Change this path to your actual Downloads folder path
DOWNLOADS_FOLDER = os.path.expanduser("/Users/jayebihara-burgess/Downloads/")

# Your HTML page
html_content = """
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Jay Ebihara-Burgess — Photography</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  * { box-sizing: border-box; }
  body {
    margin:0;
    font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
    background:#f4f4f4;
    color:#333;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:0;
  }
  h1,h2,h3 { margin:0; }

  /* ---------- Banner ---------- */
  header.site-banner {
    width:100vw;
    height:35vh;
    background-image:url('hero.jpg');
    background-size:cover;
    background-repeat:no-repeat;
    background-position:50% 30%;
    color:#fff;
    text-align:left;
    padding:6rem 4rem;
    position:relative;
    box-shadow: 0 4px 20px rgba(0,0,0,0.25); /* banner shadow */
  }
  header.site-banner::before {
    content:"";
    position:absolute;
    inset:0;
    background:rgba(0,0,0,0.4);
    pointer-events:none;
  }
  header.site-banner .banner-content { position:relative; z-index:1; }
  header.site-banner h1 { font-size:3rem; letter-spacing:1.5px; margin-bottom:0.75rem; color:#f5f5f5; }
  header.site-banner p { font-size:1.25rem; font-weight:300; color:#dcdcdc; opacity:0.9; margin:0; }

  .divider { width:80%; height:2px; background:#b0bec5; margin:2rem 0; }

  /* ---------- Top row ---------- */
  .top-row {
    display:flex;
    gap:1rem;
    margin:2rem auto;
    max-width:1000px;
    padding:0 1rem;
    flex-wrap:wrap;
    justify-content:center;
  }
  .top-row .card {
    flex:1 1 23.5%;
    max-width:23.5%;
    min-width:150px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor:pointer;
  }
  .top-row .card:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 24px rgba(0,0,0,0.15);
  }
  .top-row img { width:100%; height:auto; border-radius:8px; display:block; }

  /* ---------- Carousel + Info Box ---------- */
  .carousel-container {
    display:flex;
    align-items:center;
    justify-content:center;
    gap:1rem;
    width:90%;
    max-width:900px;
    position:relative;
    margin-bottom:3rem;
    flex-wrap:wrap;
  }
  .carousel-wrapper {
    position:relative;
    width:50%;
    height:500px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .carousel img {
    position:absolute;
    top:0;
    left:0;
    max-width:100%;
    max-height:100%;
    width:auto;
    height:auto;
    border-radius:12px;
    box-shadow:0 6px 20px rgba(0,0,0,0.15);
    opacity:0;
    transition:opacity 1s ease, transform 0.9s ease;
  }
  .carousel img.active { opacity:1; z-index:1; transform:scale(1.02); }
  .info-box {
    width:35%;
    background:#fff;
    border-radius:15px;
    padding:1.5rem;
    box-shadow:0 6px 20px rgba(0,0,0,0.08);
    display:flex;
    flex-direction:column;
    justify-content:center;
    height:510px;
  }
  .info-box h3 { margin-bottom:0.75rem; font-size:1.5rem; }
  .info-box p { margin:0; line-height:1.5; font-size:1rem; color:#555; }
  .arrow {
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    background:#fff;
    border:2px solid #333;
    border-radius:50%;
    width:45px;
    height:45px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    transition:background 0.2s, transform 0.2s;
    z-index:2;
  }
  .arrow:hover { background:#f0f0f0; transform:translateY(-50%) scale(1.08); }
  .arrow.left { left:-60px; }
  .arrow.right { right:-60px; }

  /* ---------- Lightbox ---------- */
  .lightbox-overlay {
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:1000;
    opacity:0;
    pointer-events:none;
    transition:opacity 1s ease;
  }
  .lightbox-overlay.show { opacity:1; pointer-events:auto; }
  .lb-backdrop { position:absolute; inset:0; background:rgba(0,0,0,0.85); }
  .lb-container {
    position:relative;
    width:60%;
    height:70vh;
    background:white;
    padding:1rem;
    border-radius:8px;
    display:flex;
    flex-direction:row;
    align-items:center;
    gap:1rem;
    justify-content:flex-end;
  }
  .lb-container img {
    position:absolute;
    max-width:65%;
    max-height:70vh;
    border-radius:8px;
    object-fit:contain;
    margin-right:26%;
    box-shadow:0 4px 16px rgba(0,0,0,0.15);
    opacity:0;
    transition:opacity 1s ease, transform 0.9s ease;
  }
  .lb-container img.active { opacity:1; z-index:1; transform:scale(1.02); }
  #topLbText { margin-bottom:0rem; width:30%; margin-right:-6%; display:flex; flex-direction:column; justify-content:center; }
  #topLbText h3 { font-size:1.5rem; margin-bottom:0.5rem; }
  #topLbText p { font-size:1rem; line-height:1.5; color:#555; }

  .lb-close, .lb-nav { background:none; border:none; cursor:pointer; font-size:2rem; color:#000; position:absolute; }
  .lb-close { top:10px; right:10px; }
  .lb-prev { left:10px; top:50%; transform:translateY(-50%); }
  .lb-next { right:10px; top:50%; transform:translateY(-50%); }

  /* ---------- Full-width Static Row ---------- */
  .static-row { display:flex; flex-wrap:wrap; width:100%; margin:2rem 0; gap:2rem; justify-content:center; }
  .static-item { display:flex; flex-wrap:wrap; background:#fff; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.08); overflow:hidden; }
  .static-side { flex-direction:row; align-items:center; }
  .static-side img { width:50%; height:auto; }
  .static-side .static-desc { width:50%; padding:1rem; text-align:left; }
  .static-bottom { flex-direction:column; }
  .static-bottom img { width:100%; height:auto; }
  .static-bottom .static-desc { width:100%; padding:1rem; text-align:center; }
  .static-desc h3 { margin-bottom:0.5rem; }
  .static-desc p { margin:0; color:#555; font-size:0.95rem; }

  @media (max-width:900px){
    .carousel-container{flex-direction:column;}
    .carousel-wrapper,.info-box{width:90%; height:auto;}
    .info-box{margin-top:1rem; height:auto;}
    .lb-container{flex-direction:column; width:90%; height:auto;}
    .lb-container img{position:relative; max-width:100%; max-height:300px; margin-right:0; margin-bottom:1rem;}
    #topLbText{width:100%;}
    .static-item{width:98%;}
    .static-side img{width:50%;}
    .static-side .static-desc{width:50%;}
  }
</style>
</head>
<body>

<header class="site-banner">
  <div class="banner-content">
    <h1>Jay Ebihara-Burgess</h1>
    <p>Photography Portfolio: 2023 - Present</p>
  </div>
</header>

<div class="divider"></div>

<!-- Top Row -->
<div class="top-row">
  <div class="card"><img src="2.jpg" alt="Photo 2"></div>
  <div class="card"><img src="3.jpg" alt="Photo 3"></div>
  <div class="card"><img src="5.jpg" alt="Photo 5"></div>
  <div class="card"><img src="6.jpg" alt="Photo 6"></div>
</div>

<div class="divider"></div>

<!-- Carousel -->
<div class="carousel-container">
  <div class="arrow left" onclick="moveCarousel(-1)">&#9664;</div>
  <div class="carousel-wrapper">
    <div class="carousel" id="carousel">
      <img src="1.jpg" class="active" alt="Vertical 1">
      <img src="4.jpg" alt="Vertical 2">
      <img src="10.jpg" alt="Vertical 3">
      <img src="11.jpg" alt="Vertical 4">
    </div>
  </div>
  <div class="info-box" id="infoBox">
    <h3>Placeholder Title 1</h3>
    <p>Placeholder description or camera settings for this image.</p>
  </div>
  <div class="arrow right" onclick="moveCarousel(1)">&#9654;</div>
</div>

<div class="divider"></div>

<!-- Full-width Static Row -->
<div class="static-row">
  <div class="static-item static-bottom" style="width:28%;">
    <img src="8.jpg" alt="Photo 8">
    <div class="static-desc">
      <h3>Photo 8</h3>
      <p>Description below the image.</p>
    </div>
  </div>
  <div style="display:flex; flex-direction:column; width:48%; gap:2rem;">
    <div class="static-item static-side">
      <img src="7.jpg" alt="Photo 7">
      <div class="static-desc">
        <h3>Photo 7</h3>
        <p>Description on the side of the image.</p>
      </div>
    </div>
    <div class="static-item static-side">
      <img src="9.jpg" alt="Photo 9">
      <div class="static-desc">
        <h3>Photo 9</h3>
        <p>Description on the side of the image.</p>
      </div>
    </div>
  </div>
</div>

<div class="divider"></div>

<!-- Lightbox -->
<div id="topLightbox" class="lightbox-overlay" aria-hidden="true">
  <div class="lb-backdrop" id="topLbBackdrop"></div>
  <div class="lb-container">
    <button class="lb-close" id="topLbClose" aria-label="Close">&times;</button>
    <button class="lb-nav lb-prev" id="topLbPrev" aria-label="Previous">&#10094;</button>

    <img src="2.jpg" class="active" alt="Photo 2">
    <img src="3.jpg" alt="Photo 3">
    <img src="5.jpg" alt="Photo 5">
    <img src="6.jpg" alt="Photo 6">

    <div id="topLbText">
      <h3 id="topLbTitle">Photo Title</h3>
      <p id="topLbDesc">Default description here.</p>
    </div>

    <button class="lb-nav lb-next" id="topLbNext" aria-label="Next">&#10095;</button>
  </div>
</div>

<script>
  // Carousel
  const carousel=document.getElementById("carousel");
  const images=carousel.querySelectorAll("img");
  const infoBox=document.getElementById("infoBox");
  const infoData=[
    {title:"Placeholder Title 1",description:"Placeholder description or camera settings for this image."},
    {title:"Placeholder Title 2",description:"Placeholder description or camera settings for this image."},
    {title:"Placeholder Title 3",description:"Placeholder description or camera settings for this image."},
    {title:"Placeholder Title 4",description:"Placeholder description or camera settings for this image."},
  ];
  let currentIndex=0;
  function updateCarousel(){ 
    images.forEach((img,i)=>img.classList.toggle("active",i===currentIndex));
    infoBox.querySelector("h3").textContent=infoData[currentIndex].title;
    infoBox.querySelector("p").textContent=infoData[currentIndex].description;
  }
  function moveCarousel(dir){ 
    currentIndex+=dir; 
    if(currentIndex<0) currentIndex=images.length-1; 
    if(currentIndex>=images.length) currentIndex=0; 
    updateCarousel(); 
  }
  updateCarousel();

  // Lightbox
  const topImages=document.querySelectorAll('.top-row img');
  const lbContainer=document.querySelector('#topLightbox .lb-container');
  const lbImages=lbContainer.querySelectorAll('img');
  const lbTitle=document.getElementById('topLbTitle');
  const lbDesc=document.getElementById('topLbDesc');
  const lbClose=document.getElementById('topLbClose');
  const lbPrev=document.getElementById('topLbPrev');
  const lbNext=document.getElementById('topLbNext');
  const lbBackdrop=document.getElementById('topLbBackdrop');

  const topTitles=["Porsche Boxtser","Motherhood","Lotus Elise","Station Phoenix<br>Road"];
  const topDescriptions=[
    "Brands Hatch Track Day:<br><br>Canon R10<br>Focal length: 180mm<br>ISO: 100<br>Exposure: 1/50<br>Aperture: f/25",
    "Kōjima Island:<br><br>Canon R10<br>Focal length: 215mm<br>ISO: 800<br>Exposure: 1/4000<br>Aperture: f/6.3",
    "Nichinan City:<br><br>Canon R10<br>Focal length: 45mm<br>ISO: 250<br>Exposure: 1/640<br>Aperture: f/6.3",
    "Nichinan City:<br><br>Canon R10<br>Focal length: 45mm<br>ISO: 250<br>Exposure: 1/640<br>Aperture: f/6.3"
  ];
  let lbIndex=0;

  function openLightbox(index){
    lbIndex=index;
    lbImages.forEach((img,i)=>img.classList.toggle('active',i===lbIndex));
    lbTitle.innerHTML = topTitles[lbIndex];
    lbDesc.innerHTML = topDescriptions[lbIndex];
    document.getElementById('topLightbox').classList.add('show');
    document.getElementById('topLightbox').setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden';
  }

  function closeLightbox(){
    document.getElementById('topLightbox').classList.remove('show');
    document.getElementById('topLightbox').setAttribute('aria-hidden','true');
    document.body.style.overflow='';
  }

  function prevLightbox(){
    lbIndex=(lbIndex+lbImages.length-1)%lbImages.length;
    lbImages.forEach((img,i)=>img.classList.toggle('active',i===lbIndex));
    lbTitle.innerHTML = topTitles[lbIndex];
    lbDesc.innerHTML = topDescriptions[lbIndex];
  }

  function nextLightbox(){
    lbIndex=(lbIndex+1)%lbImages.length;
    lbImages.forEach((img,i)=>img.classList.toggle('active',i===lbIndex));
    lbTitle.innerHTML = topTitles[lbIndex];
    lbDesc.innerHTML = topDescriptions[lbIndex];
  }

  topImages.forEach((img,i)=>img.addEventListener('click',()=>openLightbox(i)));
  lbClose.addEventListener('click', closeLightbox);
  lbPrev.addEventListener('click', prevLightbox);
  lbNext.addEventListener('click', nextLightbox);
  lbBackdrop.addEventListener('click', closeLightbox);

  window.addEventListener('keydown', ev=>{
    if(!document.getElementById('topLightbox').classList.contains('show')) return;
    if(ev.key==='Escape') closeLightbox();
    if(ev.key==='ArrowLeft') prevLightbox();
    if(ev.key==='ArrowRight') nextLightbox();
  });
</script>

<footer style="width:100%; text-align:center; padding:1rem 0; background:#f4f4f4; color:#555;">
  <p>&copy; 2025 Jay Ebihara-Burgess. All rights reserved.</p>
</footer>

</body>
</html>
"""

class MyHandler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        if self.path in ["/", "/index.html"]:
            self.send_response(200)
            self.send_header("Content-type", "text/html; charset=utf-8")
            self.end_headers()
            self.wfile.write(html_content.encode("utf-8"))
        else:
            file_path = os.path.join(DOWNLOADS_FOLDER, self.path.lstrip("/"))
            if os.path.isfile(file_path):
                self.send_response(200)
                if file_path.endswith(".jpg"):
                    self.send_header("Content-type", "image/jpeg")
                elif file_path.endswith(".png"):
                    self.send_header("Content-type", "image/png")
                else:
                    self.send_header("Content-type", "application/octet-stream")
                self.end_headers()
                with open(file_path, "rb") as f:
                    self.wfile.write(f.read())
            else:
                self.send_error(404, "File not found")

# Try each port until one works
for PORT in PORTS:
    try:
        with socketserver.TCPServer(("", PORT), MyHandler) as httpd:
            print(f"Serving portfolio at http://localhost:{PORT}")
            webbrowser.open(f"http://localhost:{PORT}")
            httpd.serve_forever()
        break
    except OSError as e:
        print(f"Port {PORT} failed: {e}, trying next port...")
